import './polyfills.server.mjs';
import{a as te}from"./chunk-HY5KGVWL.mjs";import{b as Y}from"./chunk-OGLBR6HM.mjs";import{a as Z,b as ee}from"./chunk-UJU4AMN6.mjs";import{c as X}from"./chunk-2BOR5ZK6.mjs";import{b as K,c as Q}from"./chunk-EZPNG7AR.mjs";import{i as N}from"./chunk-XD6EPKYL.mjs";import{$ as J,A as I,B as A,E as B,G as V,H as k,I as D,K as $,U as j,V as z,X as R,Y as W,Z as H,i as O,x as G,y as u}from"./chunk-IZTS57U6.mjs";import{Ab as x,Cc as q,H as b,Jb as T,Kb as U,La as d,Mc as L,Q as C,S,Wa as f,X as y,Y as P,Za as h,ab as m,bb as s,eb as i,fb as t,gb as c,kb as w,m as E,mb as F,nb as _,sb as a,zb as M}from"./chunk-UJH6JCXP.mjs";import{a as v}from"./chunk-KRLCULJA.mjs";var ie=e=>e.value.password===e.value.confirmPassword?null:{PasswordNoMatch:!0};function oe(e,r){e&1&&(i(0,"div",4)(1,"div",5),c(2,"img",6),t()()),e&2&&(d(2),f("ngSrc",r.photo))}function re(e,r){e&1&&(i(0,"span",27),a(1,"El nombre es requerido"),t())}function ae(e,r){e&1&&(i(0,"span",27),a(1,"El nombre debe tener al menos 3 caracteres"),t())}function le(e,r){e&1&&(i(0,"span",27),a(1,"El nombre de usuario es requerido"),t())}function de(e,r){e&1&&(i(0,"span",27),a(1,"El nombre de usuario debe tener al menos 8 caracteres"),t())}function me(e,r){e&1&&(i(0,"span",27),a(1,"El correo electronico es requerido"),t())}function se(e,r){e&1&&(i(0,"span",27),a(1,"El email no es v\xE1lido"),t())}function pe(e,r){e&1&&(i(0,"span",27),a(1,"La contrase\xF1a es requerida."),t())}function ue(e,r){e&1&&(i(0,"span",27),a(1,"La contrase\xF1a debe tener al menos 8 caracteres"),t())}function ce(e,r){e&1&&(i(0,"span",27),a(1," Las contrase\xF1as no coinciden. "),t())}function fe(e,r){if(e&1&&(i(0,"div",9)(1,"p-floatLabel"),c(2,"input",28),i(3,"label",29),a(4,"Contrase\xF1a"),t()(),m(5,pe,2,0,"span",12)(6,ue,2,0)(7,ce,2,0),t()),e&2){let o=_(2);d(5),s(5,o.getFieldError("password","required")?5:o.getFieldError("password","minlength")?6:o.getFieldError("password","compareFields")?7:-1)}}function _e(e,r){e&1&&(i(0,"span",27),a(1,"El telefono es requerido"),t())}function Ce(e,r){e&1&&(i(0,"span",27),a(1,"El genero es requerido"),t())}function he(e,r){e&1&&(i(0,"span",27),a(1,"El nombre es requerido"),t())}function xe(e,r){e&1&&(i(0,"span",27),a(1,"Las contrase\xF1as no coinciden."),t())}function ge(e,r){if(e&1&&(i(0,"div",9)(1,"p-floatLabel"),c(2,"input",30),i(3,"label",29),a(4,"Confirmar Contrase\xF1a"),t()(),m(5,xe,2,0,"span",12),t()),e&2){let o=_(2);d(5),s(5,o.formGroup.errors!=null&&o.formGroup.errors.PasswordNoMatch?5:-1)}}function ve(e,r){if(e&1){let o=w();i(0,"button",31),F("click",function(){y(o);let l=_(2);return P(l.saveUser())}),t()}if(e&2){let o=_(2);f("label",o.getLabel())("disabled",o.formGroup.invalid)}}var ne=()=>({width:"221px"});function Ee(e,r){if(e&1&&(i(0,"form",7)(1,"div",8)(2,"div",9)(3,"p-floatLabel"),c(4,"input",10),i(5,"label",11),a(6,"Nombre Completo"),t()(),m(7,re,2,0,"span",12)(8,ae,2,0),t(),i(9,"div",9)(10,"p-floatLabel"),c(11,"input",13),i(12,"label",14),a(13,"Nombre de Usuario"),t()(),m(14,le,2,0,"span",12)(15,de,2,0),t(),i(16,"div",9)(17,"p-floatLabel"),c(18,"input",15),i(19,"label",16),a(20,"Email"),t()(),m(21,me,2,0,"span",12)(22,se,2,0),t(),m(23,fe,8,1,"div",17),t(),i(24,"div",18)(25,"div",9)(26,"p-floatLabel"),c(27,"input",19),i(28,"label",20),a(29,"Tel\xE9fono"),t()(),m(30,_e,2,0,"span",12),t(),i(31,"div",9)(32,"p-floatLabel")(33,"p-dropdown",21),a(34," >"),t(),i(35,"label",22),a(36,"Sexo"),t()(),m(37,Ce,2,0,"span",12),t(),i(38,"div",9)(39,"p-floatLabel")(40,"p-dropdown",23),a(41," >"),t(),i(42,"label",24),a(43,"Rol"),t()(),m(44,he,2,0,"span",12),t(),m(45,ge,6,1,"div",17),t()(),i(46,"div",25),m(47,ve,1,2,"button",26),t()),e&2){let o=_();f("formGroup",o.formGroup),d(7),s(7,o.getFieldError("name","required")?7:o.getFieldError("name","minlength")?8:-1),d(7),s(14,o.getFieldError("username","required")?14:o.getFieldError("name","minlength")?15:-1),d(7),s(21,o.getFieldError("email","required")?21:o.getFieldError("email","email")?22:-1),d(2),s(23,o.mode==="add"?23:-1),d(7),s(30,o.getFieldError("telephone","required")?30:-1),d(3),h(x(16,ne)),f("options",o.genders),d(4),s(37,o.getFieldError("gender","required")?37:-1),d(3),h(x(17,ne)),f("options",o.roles),d(4),s(44,o.getFieldError("role","required")?44:-1),d(),s(45,o.mode==="add"?45:-1),d(2),s(47,o.mode==="edit"||o.mode==="add"?47:-1)}}function be(e,r){e&1&&c(0,"p-progressSpinner",32)}var Xe=(()=>{let r=class r{constructor(){this.title="Perfil de Usuario",this.mode="view",this.messageService=C(O),this.roles=[{id:1,name:"SysAdmin"},{id:2,name:"Admin"},{id:3,name:"Empleado"}],this.genders=[{id:1,name:"Masculino"},{id:2,name:"Femenino"}],this.formBuilder=C(D),this.userService=C(te),this.route=C(N)}ngOnInit(){switch(this.mode=this.getActionType(),this.mode){case"add":this.buildForm();break;case"edit":this.loadUser(this.mode);break;case"view":this.loadUser(this.mode),this.formGroup.disable();break}}ngOnDestroy(){this.formGroup.reset()}loadUser(n="view"){let l=this.route.snapshot.paramMap.get("id");["view","edit"].includes(n)&&l&&(this.user$=this.userService.getUserById(+l).pipe(E(p=>p.result),b(p=>(this.buildForm(p),p))))}getActionType(){let n=this.route.snapshot.url;return n.some(l=>l.path==="new")?"add":n.some(l=>l.path==="edit"||l.path==="user-profile")?"edit":"view"}getIndexedArray(n){return n.reduce((l,p)=>(l[p.id]=p,l),[])}buildForm(n){this.formGroup=this.formBuilder.group({username:[n?n.username:"",[u.required,u.min(8)]],email:[n?n.email:"",[u.required,u.email]],gender:[n?this.getIndexedArray(this.genders)[n.gender.id]:"",[u.required]],name:[n?n.name:"",[u.required,u.minLength(3)]],role:[n?this.getIndexedArray(this.roles)[n.role.id]:"",[u.required]],telephone:[n?n.telephone:"",[u.required]]}),this.mode==="add"&&(this.formGroup.addControl("password",this.formBuilder.control("",[u.required,u.minLength(8)])),this.formGroup.addControl("confirmPassword",this.formBuilder.control("",[u.required])),this.formGroup.setValidators(ie))}saveUser(){let n=this.formGroup.value;this.mode==="add"&&this.userService.createUser(n).subscribe(l=>{this.messageService.add({severity:"success",summary:"Exito",detail:`El usuario ${l.result.username} ha sido creado.`}),this.formGroup.reset()}),this.mode==="edit"&&(n=v({id:Number(this.route.snapshot.paramMap.get("id"))},n),this.userService.updateUser(n).subscribe(l=>{this.messageService.add({severity:"success",summary:"Exito",detail:`El usuario ${l.result.username} ha sido actualizado.`})}))}getLabel(){return this.mode==="add"?"Crear":"Actualizar"}getFieldError(n,l){let p=this.formGroup.get(n);return(p?.touched&&p?.hasError(l))??!1}};r.\u0275fac=function(l){return new(l||r)},r.\u0275cmp=S({type:r,selectors:[["event-trackr-user-profile"]],inputs:{user$:"user$"},standalone:!0,features:[M],decls:8,vars:4,consts:[[1,"user-profile"],["rel","preconnect","href","https://avatar.iran.liara.run"],["class","user-profile__header"],[1,"user-profile__body"],[1,"user-profile__header"],[1,"user-profile__header__avatar"],["priority","","width","200","height","200","placeholder","",3,"ngSrc"],[3,"formGroup"],[1,"user-profile__body__left"],[1,"field-wrap"],["id","name","pInputText","","formControlName","name"],["for","name"],["class","error"],["id","username","pInputText","","formControlName","username"],["for","username"],["id","email","pInputText","","formControlName","email"],["for","email"],["class","field-wrap"],[1,"user-profile__body__right"],["id","phone","pInputText","","formControlName","telephone"],["for","phone"],["inputId","gender","optionLabel","name","formControlName","gender","autoWidth","true",3,"options"],["for","gender"],["inputId","role","optionLabel","name","formControlName","role","autoWidth","true",3,"options"],["for","role"],[1,"user-profile__footer"],["pButton","","type","button",3,"label","disabled"],[1,"error"],["id","password","type","password","pInputText","","formControlName","password"],["for","password"],["id","confirmPassword","pInputText","","formControlName","confirmPassword","type","password"],["pButton","","type","button",3,"label","disabled","click"],["mode","indeterminate"]],template:function(l,p){if(l&1&&(i(0,"div",0)(1,"head"),c(2,"link",1),t(),m(3,oe,3,1,"div",2),T(4,"async"),i(5,"div",3),m(6,Ee,48,18)(7,be,1,0),t()()),l&2){let g;d(3),s(3,(g=U(4,2,p.user$))?3:-1,g),d(3),s(6,p.formGroup?6:7)}},dependencies:[Y,$,B,G,I,A,V,k,W,R,z,j,Q,K,L,q,ee,Z,J,H,X],styles:[".user-profile[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%}.user-profile__header__avatar[_ngcontent-%COMP%]{margin-top:32px;display:flex;justify-content:center;align-items:center;gap:16px}.user-profile[_ngcontent-%COMP%]   .field-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-width:250px;height:55px}.user-profile[_ngcontent-%COMP%]   .field-wrap[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#ff4c4c;font-size:.8rem}.user-profile__body[_ngcontent-%COMP%]{margin-top:64px}.user-profile__body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;gap:32px}.user-profile__body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .p-dropdown{width:100%;min-width:150px}.user-profile__body__left[_ngcontent-%COMP%], .user-profile__body__right[_ngcontent-%COMP%]{display:flex;gap:32px;flex-direction:column;align-items:center;justify-content:center;width:100%}.user-profile__footer[_ngcontent-%COMP%]{margin-top:64px;display:flex;justify-content:center;gap:32px}"]});let e=r;return e})();export{Xe as UserProfileComponent};
