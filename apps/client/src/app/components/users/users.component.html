<div class="users">
  <header>
    <p-button
      label="Agregar Usuario"
      icon="pi pi-user-plus"
      iconPos="right"
      severity="success"
      (click)="addUser()"
    />
  </header>
  <p-table [value]="(users$ | async) ?? []">
    <ng-template pTemplate="header">
      <tr>
        <th>ID</th>
        <th>Nombre de Usuario</th>
        <th>Nombre</th>
        <th>Email</th>
        <th>Acciones</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user>
      <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.name }}</td>
        <td>{{ user.email }}</td>
        <td class="actions">
          <p-button
            type="button"
            icon="pi pi-pencil"
            severity="warning"
            [rounded]="true"
            (click)="editUser(user)"
            [size]="'small'"
          ></p-button>
          <p-button
            type="button"
            icon="pi pi-trash"
            severity="danger"
            [rounded]="true"
            (click)="deleteUser(user, $event)"
            [size]="'small'"
            [disabled]="!canDelete(user.id)"
          ></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-confirmDialog />
